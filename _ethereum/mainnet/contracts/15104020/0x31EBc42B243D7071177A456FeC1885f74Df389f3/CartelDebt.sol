//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXK0KXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKx:,ckKXKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKOc.   'o0KXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0o'      .;xKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKx;.         .ckKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKkc.             'o0KXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXK0o'                .;xKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0d,.                   .ckKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKk:.                       'o0KXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKOc.                          .;xKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKOo'                              .ckKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXK0d,                                  'lOKXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXX0d;.         ..',,,,,,,,,,'....         .,d0XXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXKx:.      .';clodddolcc:::;;;;;;;,...       .:kKXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXKkc.     .,cdxxxxxxddolc:;;;;;,,,,,,'''...      .lOKXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXKOl'     .:dxxkkkkkxkxdddddddooolc:;,''''......    .,d0XXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXX0d,.    .;lxOO00OOOOOOOkkOOO00000Okxol:;'''......     .:kKXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXKk:.     .;cdOO0KKKKK0OOOO0KKKXXXXXK0Okxoc;,'........     .o0XXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXX0o'      .:clodOKXXXXXXK000KXXXXXXXXK00Oxdl;,'.........     .;xKXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXKk:.      .;coxlok0KXXXXXKKKKKXXXXXXXXK0Okxoc;''''''......      .l0XXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXX0o'        .;:lolok0KXXXXXXXXXXXXXXKKXK0Okkdl:,'',,'.......       .;kKXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXKk:.         ';,;::lk0KXKKKKKKKKXKKK0O00OOOkdl:,'',;,........         'o0XXXXXXXXXXXXXX
//    XXXXXXXXXXXXKx,          .:c,.'';OKKXKKK0OkkkO0OkxxkOOkxol::::::;'.   ....          .cOKXXXXXXXXXXXX
//    XXXXXXXXXXX0o.           .cd:...;OXXXKK000OkkdxxxkOOOxolccldddoc;'.   ..''.           ,xKXXXXXXXXXXX
//    XXXXXXXXXXOc.            'lxd'.;OX0Oxl:;,;:ldxdlldkxoc;,,;:clooc;'..  ..''.            'd0XXXXXXXXXX
//    XXXXXXXXKO:.             .cxo,lko;..        ':ll:cdc,...     ..''...  ..''.             .l0XXXXXXXXX
//    XXXXXXXKk;               .;c:cx:            .::;:;'...            ..  ...'.              .cOXXXXXXXX
//    XXXXXXKk;                 '.'dd......       .cold: ...          .....  ...                .cOKXXXXXX
//    XXXXXKk;                  ...xO'.,''..     ..lxlo:....         ..'.... ...                 .cOXXXXXX
//    XXXXXO:.                  .,,xK:..'.......,;lxd;'. .....      ..,,''..  ..                  .c0XXXXX
//    XXXX0l.                   ,OKKXk;....':ccldOOko'    .'........ ...'......                    .o0XXXX
//    XXXKd.                     'lkKX0kxdxkkxxkO0Oxc.     .'..'',,.........'.                      .dKXXX
//    XXXO;                       .,o0K0Okxdold0KKOd'      .,....;colc;'.....                        ;OXXX
//    XXKo.                       .'.,:;,;cccldOKKk:.      ......',:llc;.....                        .l0XX
//    XXO,                        .'..,,..'cddxkOOd:. ...  ... ....''...  ...                         ,kXX
//    XKd.                          ..,:;. .c0K000Oxlcl,   ........     . ..                          .oKX
//    XKl.                            .::.  .kXXK0O0KKx,.'''..'','   ....                              c0X
//    X0:                             .cl;.. :O0OdodkOdlllc;'.'...   ....                              ;OX
//    X0:                             .cxo:'.:xkxxdldxdoolcl:'...   ...'.                              ,OX
//    X0l.                             ckkx:,cdxxddddxdodoldc,''.  ...''                               :0X
//    XKd.                             ;O0KOooxxxxddddllooodc'.'....'...                              .l0X
//    XXO;                             'x0KX0xkOddddkdooolcc,..,,.''....                              .xKX
//    XXKo.                            .dkOKKkk0000KX00K0OOkl,'::;;'....                              c0XX
//    XXX0c.                            ;llkK0kkO0XXXXK0000OOl,;:::'..                               ,kKXX
//    XXXKO:.                             .'dO0K0KXXKKK000OOkl;;;;'.                                'xKXXX
//    XXXXXO:.                              .,cx0KKXKKOkkkkxdc,...                                 ,xKXXXX
//    XXXXXX0o.                                 .';;;:,'''....                                   .:kKXXXXX
//    XXXXXXXKk:.                                                                               'o0XXXXXXX
//    XXXXXXXXXKxc.                           .;oxdc.      .,odl,.                           .,oOKXXXXXXXX
//    XXXXXXXXXXXKOdc'.                   .':okKXXX0:      ,kXXX0ko;..                   ..,lk0KXXXXXXXXXX
//    XXXXXXXXXXXXXXK0Oxlc;,'......',,;:ldk0KXXXXXXO;      'kKXXXXXKOxoc:,'..........,;coxOKXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXKKK00000000KKKKXXXXXXXXXXKx.      .oKXXXXXXXXXXKK00OOOOOOOO0KKKXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0c.       ;OXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKx.        .oKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXO:          ,kXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKo.          .c0XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKd.            .o0XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKx'              .dKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKd'       ..       .o0XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXK0l.   ..'::;,;:,..   .cOKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKk;.     ..,c:::,..      ;xKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0o.          .;:'          .l0XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKx;.            ..            .;xKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKkl;;;;;;;;,,,,,,,,,,,,,;;;;;;;;;lkKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//    XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
//
//    To Whom It May Concern (aka DEA/FBI): This project is "performance art".
//
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.4;

import "./ERC721.sol";
import "./Ownable.sol";
import "./Counters.sol";

contract CartelDebt is ERC721, Ownable {
    using Counters for Counters.Counter;
    Counters.Counter private tokens;

    string public baseUri;
    string public placeholderUri;
    uint256 public collected;
    uint256 public constant needed = 200 ether;

    constructor() ERC721("Cartel Debt", "CARTEL") {}

    function mint() public payable {
        require(collected <= needed);
        require(msg.value > 0);
        collected += msg.value;
        tokens.increment();
        _safeMint(msg.sender, tokens.current());
    }

    function totalSupply() public view returns(uint256) {
        return tokens.current();
    }

    function setBaseUri(string memory _baseUri) public onlyOwner {
        baseUri = _baseUri;
    }

    function setPlaceholderUri(string memory _placeholderUri) public onlyOwner {
        placeholderUri = _placeholderUri;
    }

    function tokenURI(uint256 tokenId) override public view returns (string memory) {
        if(bytes(baseUri).length > 0) {
            return string(abi.encodePacked(baseUri, toString(tokenId)));
        }
        return placeholderUri;
    }

    function withdraw() public payable onlyOwner {
        require(payable(msg.sender).send(address(this).balance));
    }

    function toString(uint256 value) internal pure returns (string memory) {
        if (value == 0) {
            return "0";
        }
        uint256 temp = value;
        uint256 digits;
        while (temp != 0) {
            digits++;
            temp /= 10;
        }
        bytes memory buffer = new bytes(digits);
        while (value != 0) {
            digits -= 1;
            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));
            value /= 10;
        }
        return string(buffer);
    }
}
