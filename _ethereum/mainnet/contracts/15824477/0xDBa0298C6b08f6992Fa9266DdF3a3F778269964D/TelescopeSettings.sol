// SPDX-License-Identifier: MIT

// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNK0kxooooodddxk0NWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0kxolc:;;;;;;;;;,''';lkKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0kdl::cloooddoooodddoolc;,.,dXMMMMWWMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKOxoccllllloddol:,,:odxxdddxddl,'oOOkkkkOOOO0KXWMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0dlccloodddodddxxl'   'clldxxdlc::;;ldxOOO00OOkxxxkOO0NWMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOoccoooc:ldxxdddxxdl;',;,...;lccccldoloxddodk0000OkddxkxxkKWMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0oclooc;'...lxxxdxdoodkxdo;..,;coxxxxkdll:....;d00x:'...:k0kdOWMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKdcclloo;.....cddddoldkkdoccllodolodxxxxxo;......l00c......okdllOWMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXd:::clooc::cllooollloxxoc:cloxxxc...;oxxdol;....'ck0xl;'.'';:...,lOWMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOc;;...:oc:;,;cdolcclool::cldol:cc'  ..lxdc;lxdlodkkdodO0Okkd:,..'lxo0MMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXxc:l:'',:ll;...colloolc:::ldo:.....,;;codl::oxkkkkdlodxkkkkxdl::::cdOddXMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXd:colcolcclccclllloooc::lodxx:. ....;cclc::oxddxxdodxOOOkdloxO0kdllodOko0MMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWk:colcllcllldolllddoc;;coxxdoo:,,'',c;...':odddolldkOOOkdoodk0Oxoooodddoo0MMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMKlcolclllloddoloddoc:'.'lddxdl:cdxxxdl'...'lxxdlodkkkxolldxdodo,....:oddclKMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMWNX0Oxdoooooodk0XWMMMMMNkccc:;;::col:llc:;;;'....:xkolldoooo::c:;cdddooxkkkdooodxxxdd:.  ....cddcdNMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMN0kdl:,.          ..;dO0kddl;,,,,',,;;,',,'....'.....:oc:looooolokxlodoodxkOkdlldkkkkxxxkc.  ...'ldooKMMMMMMMM
// MMMMMMMMMMMMMMMMMMWXxlldxO0K0o.     .',,;,''',,''',;cooodollooooc;''',,;::;,,;:::;,,;odxxdlldkkkxooodxdxkkOkxddlc:;;:codoo0WMMMMMMMM
// MMMMMMMMMMMMMMMMW0l''dXWMMMWNx. .';;::;,,,,,;;:c:coxkkkOkxxxxxxd:'';;,:loc;:odo:,',;::c:;,,coollooxxdoloxkkdooxkOOkxxxoloKWMMMMMMMMW
// MMMMMMMMMMMMMMWOc.  cXWWX0xc,.,:::c::cc:::;;;:cloxkkOOOkxkkxoddc,;:;;:c:::lxkd:;:lxxolc:;,;;,,,;cddodooollloxOOkkkxdoc:dXMMMMMMMMMMW
// MMMMMMMMMMMMMWx.  ..':c;'. .:c:;:cllccc::::;;:coxxddxxxddxdooo:',;,:l:;:ldkko;';odolcllc:;;;;,',colc:;;:cloxkOOOOkxo::xNMMMMMMMMMMMM
// MMMMMMMMMMMMMWOc;,''...    ',',cllc::::::;,,;codddddxddxddddo:',;;cc;;clolc:;,',c:,:ooc:::::;'':dolllcc:,'';dkkkkkd:l0WMMMMMMMMMMMMM
// MMMMMMMMMMWXkc'.               ..,;;::;;;;,,:loooddxddkkxxxd:.'',:;,',ll:;;:clcc:..;lc:c::c:clllllooooo,. ..;dxxdcckNMMMMMMMMMMMMMMM
// MMMMMMMMWKl'    .;cooc'           ..;::;,,,;ldxxkOO00KKKOOKk;',,'.....,;;:lodoccc::cc:ccc:cloolloodollc,...',clclxXMMMMMMMMMMMMMMMMM
// MMMMMMMXo.   .cOXWMMMMXx,           .,c:;,;cdOKKKKXXXXXXKK0c'','.'','';ccccoolllll:colllc:clododolllllddoooc''',dNWMMMMMMMMMMMMMMMMM
// MMMMMM0;   .cKWMMMMMMMMM0'           .,;;:lddk0KK00XXXXXXKd,.''';c;,,:cc:ccccclccllodol:;coollll:::,;oxolo:;:oo:;dXMMMMMMMMMMMMMMMMM
// MMMMM0;   .dNMMMMMMMMMMMX:             ':lkkxxOKKKKXXX00XKd,..',;;,;c::ccc:::loooooo:,;;;clcclcc:c;.'clc:::okOkd::kWMMMMMMMMMMMMMMMM
// MMMMNc    oWMMMMMMMMMMMM0'             .;xOkxkO0KKXXXXKKXOdc',,';::::::::::colldoooc,..':llcclloddoc:;;codxkOOxxd:c0WMMMMMMMMMMMMMMM
// MMMMk.   .OMMMMMMMMMMMW0;               'odoook00KXXXXXXXOo:;c:;:,',;,',;cclolcol;;::;;;::'..:dxdc:cookK0OOkkkOOxl;dNMMMMMMMMMMMMMMM
// MMMWd    .lNMMMMMMMMWKo.                .cdoook0KKXXXXXX0xl;;::lolc:,'';clcclc:clccc:;;::;;;:::llldKXXKXK0K0xdkOkdcoXMMMMMMMMMMMMMMM
// MMMWo      ,oOKNNX0x:.                  .lxkxdOKKK0000XXKxc,,:ldxxxdllc:c:,;cccc:::::::cooldxdx0K0KXXXXXXXXX0kxxkxcl0WMMMMMMMMMMMMMM
// MMMMx.        .....                     ,xOkdx00OOOkxxOOOo,,;:ldddxddxdl:,,;;:lc:c:'..,lddk0XXXXXXXK00000KK000xddo::OWMMMMMMMMMMMMMM
// MMMMK;                                 .cOkxddxkOOOxdllcol;:lccoodxxxxdxdlc:;:c:;;;,,;ckOOKKKXXX0OOOxkOkxkkddkOxooccOWMMMMMMMMMMMMMM
// MMMMWk.                   .:xxc.       ,x0OOkxkO00Oxddool::clcldddxdddoxxddl:::cc:cdoclk0xxxxO0OxkO000K0000OkOkkdlccOWMMMMMMMMMMMMMM
// MMMMMWx.                 .xWMMWk.     .lO0OO0OOOOOOkxkkxxoccodxxxkOkxdodxodxxxxdddxkoldxddkkxkxdk0000KK00KKKKKOkdcclOWMMMMMMMMMMMMMM
// MMMMMMWO,                .xNMMNx.    .;d00OOOOxxOkkkxkOxxxlloxkkO00OOkddddxxxkkxdxxxdxOkdxO000OkO00Ok0KOkKK000Oko::o0WMMMMMMMMMMMMMM
// MMMMMMMMXd'               .,::,.   .;oloO0kOOOOOOOOOOOOkkxldxxOOO0OkxxddddxxkkxxxxdddxOkxk00000000KOO0KKKK0kO0kxo:lONMMMMMMMMMMMMMMM
// MMMMMMMMMMXx:.                   .;lodooOK000000000000000kodddkOO0KOkkddxxkxxkxxxxdolldkOOOkk0OOO000KKKKKKK0000d::kNMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMWKkl;'.          ...;lodoc:ckKKKKKK0KKKOk0K00kdxOkkOO00OOkddkxkxkxolccc:;,;lxkOxk0kxk0Ok0KKK0KK0kOOl;oXMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMWNKOo;'..'',;:;;coldl;,;oO00K0OOKKKK0KKOkxoxOxdddxkkkkddxxkkxxl,'''',;;coxOOO0Oxk0OO0KKOk00Oxxo;lKWMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMWO:.,:c::c:;:;;cc;;;cxkOKK00KKKKKK0kdoccloxxoodooddoddxxddl;',,,;::ldkOOOOOOO00000KK0000klcdKWMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMNd'.,::;::cc:::c:::cokOKKK00KKKK00Oxo:'',lxoloodxdodooocc:::::;:clodxkkO0K0KKK0kOKXK000ocdKMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMXo,';:;:cclllllccc:ldkO00OO0000OOkdxo;,'':lloolddl::cclolllll:::cddxOOdd0XKKXX0OKXKOxl;dXMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMKo:,,;;cclllolc::;:ldk00OkOKKOkOOodxlc;;:llclloocllododoccloc:c:lllol:;xX0OKXKKKKKOc;oKWMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMNkc;,;::::;,,;;;,':oxkkkk0XKOkkkdkkc:::cooloooolodxxdooloooc:c::::ll:;kXXXKKXXKkdc;l0WMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMWKxl:;:c;',lool:'.;oxkO0OKX00kxOK0l;:::cc::;;;;cxxxoclooool;,;:ccll:,o0XXK0KX0l':kXWMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMWKl'',.':lllc'.':dk0XXKKXXK0O0K0d:c:,;:::c:'';dkxdllllddl:'.;cccl:,ckKXK0kxl''xWMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMKd:',clll;.';:;cx0XXXXXXXXXXX0kol;'coooo;',:dkdolloloolc;'',:lc:';kKX0dc,.',kMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMO;':cl:,.,::::;:ok0KXK0KXXXXX0dc,,loooc'':cdkxddoddlllc:;,'':lc,,ok0d,..,;;kMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMM0:,clc:,',;c;;::;,:okKKKXXXX00Od:',llol,.;ccclolooodoool:::c;';l;.:c;;ll;:c;dWMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMKc,cc:oOK0Okdl,.,;,',cxO0K00XXK0Ol',lll;.,ccc::llldoodlcllcccc,.,,..;oONWKl;,cXMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMNo';:cxNMMMMWNO;......,:oxOO00KK00d''c:;'':llcc::cccllll::c:;;,'''...cXMMMMXl.'kWMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMWk;,;lKMMMMMMMMk,,;'.,ll::clddxxdkOo'':,.';:ll::c;:c;:c:,,;;,:oookOo'.:XMMMMM0;.oWMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMK:';xNMMMMMMMMWd,:;'lKWX0Okxddocclo:.';'.';,::.....',:::lokOOKNWMMMWk';KMMMMMW0okWMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMNl.:0WMMMMMMMMMNl'',xNMMMMMMWNNXXK00x,.,cdk0O00kc.'';OXKXNWWMMMMMMMMMWOkNMMMMMMMWWMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMWx,lXMMMMMMMMMMMK;.,kWMMMMMMMMMMMMMMMXc.;0WMMMMMMXo',dWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMWOkNMMMMMMMMMMMM0,,OWMMMMMMMMMMMMMMMMWx'cXMMMMMMMMXl'xWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXxOWMMMMMMMMMMMMMMMMMMNxkWMMMMMMMMMXdkWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
// MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM

// Now the telescope is mended, we had a play with it - and what we see is just spectacular. 

// The 1875 mechanisms built within the Telescope: The gems systems helps revealing the colours of the stars and the galaxies like no 
// modern telescopes can do. The show is mind blowing.

// We found a document from the Oxford 19th Century Star Map that hinted 17 combinations of planet setting on the top of the telescope 
// - it changed the angle and focus - and everytime, the vision was different; unseen in any books. The pushing button mechanism, 
// embodied by the planets, were in fact some preset configuration carefully adjusted. The Mystery was getting deepen. 

// Here are 17 high quality pictures of the Vision from the space to thank our Visionnaires for taking part so early in 
// our Mignonverse Adventure.

// Artist: Lapin Mignon - https://twitter.com/Lelapinmignon/
// Coder: Tagachi - https://twitter.com/TagachiStudio/"

pragma solidity ^0.8.17;

import "./ERC721.sol";
import "./Ownable.sol";

contract TelescopeSettings is ERC721, Ownable {

    uint256 public totalSupply;
    uint256 public maxSupply;
    string internal baseTokenUri;
    string public hiddenMetadataUri;

    address public daoWallet;

    address[] public VisionnairesWallets;

    mapping(address => uint256) public WalletMints;

    bool public isAirdropCompleted;
    bool public hasAligned;


    constructor() payable ERC721('Telescope Settings', 'TSPS') {

        totalSupply = 0;
        maxSupply = 17;
        setHiddenMetadataUri("https://orion.mypinata.cloud/ipfs/QmbFMke1KXqnYyBBWxB74N4c5SBnJMVAiMNRcGu6x1AwQH");

        isAirdropCompleted = false;
        hasAligned = false;

        daoWallet = 0xEF247Fb4A0bb76398472af7729d9819bB446e4BB;


        //Snapshot (LAST SAFE BLOCK): 15817508
        VisionnairesWallets = [
            0x114F78f4342ae3dCBfAF61B6BF19807678754224,
            0xff88Cd0b8c1300ef503b9df32789050B02f26f4B,
            0xa5A28509ECc8a244A4f01156D028c2993f2E96bd,
            0x8E63E4376dDE62cb82f5a91C4bCE4156457dEdB1,
            0xdE090027BF758dE3Ba32078F14E91F1A263818ab,
            0x149BE352E37D092deaa69D33D4C2C77456d13F65,
            0x6353CC3C3898BAB604bbA392C77A66EbE0e92FA5,
            0xBFfAc0D7B5AfAED417C36Ec492BEA4ec16DfC8b9,
            0x01Fd524bEfa9F15A645871B9F3267eccBc7937f7,
            0x01Fd524bEfa9F15A645871B9F3267eccBc7937f7,
            0xD387A6E4e84a6C86bd90C158C6028A58CC8Ac459,
            0x616ed054e0e0fdbfCAd3fA2F42daeD3d7d4eE448,
            0x4e62324FF8098Cd2e21852d50aeec61e5302e025,
            0x5d70a49E217DBdC1a5049542d70C0fAfba5E6bF2,
            0xADC3546Ea680E21Afa7D5d45dCd03F2f8957241A,
            0xEA6F17757172B189342852744D17577408d0f6af,
            0xE55c9840eb6Ba1c75160Ed611E3C72Bc438dCA54 
        ];

    }

    //Withdrawal pattern
    function withdraw() external onlyOwner {

        uint256 _totalWithdrawal = address(this).balance;
        (bool successDao, ) = daoWallet.call{ value: _totalWithdrawal }('');
        require(successDao, 'withdraw to Tagachi failed');
    }

   function applyAlignment() external onlyOwner {
        hasAligned = true;
    }

    function setHiddenMetadataUri(string memory hiddenMetadataUri_) public onlyOwner {
        hiddenMetadataUri = hiddenMetadataUri_;
    }

    function setBaseTokenUri(string calldata baseTokenUri_) external onlyOwner {
        baseTokenUri = baseTokenUri_;
    }

    function tokenURI(uint256 tokenId_) public view override returns (string memory) {

        if (hasAligned == false) {
            return hiddenMetadataUri;
            }

        require(_exists(tokenId_), 'Token does not exist!');
        return string(abi.encodePacked(baseTokenUri, Strings.toString(tokenId_), ".json"));
    }

    string private customContractURI = "https://orion.mypinata.cloud/ipfs/QmccEsF7ffhfDqdoXtssCMs3XVdmWUardcCh12E6J6A9ET/";

    function setContractURI(string memory customContractURI_) external onlyOwner {
        customContractURI = customContractURI_;
    }

    function contractURI() public view returns (string memory) {
        return customContractURI;
    }


    //Telescope Settings: Airdrop to The Visionnaires
    function airdrop() external onlyOwner {
        require(!isAirdropCompleted, "Airdrop has already completed!");

        for(uint256 i = 0; i < VisionnairesWallets.length; i++) {
            uint256 newTokenId = i + 1;
            WalletMints[VisionnairesWallets[i]]++;
            totalSupply++;
            _safeMint(VisionnairesWallets[i],newTokenId);
        }

        isAirdropCompleted = true;
    }


}